# SNS를 통한 로그인 구현

이번 개발 진행 중 SNS 계정을 통해 회원 가입 및 로그인을 할 수 있도록 하는 기능을 개발 하게 되었다. 이를 위해 개발 전에 SNS를 통한 로그인 기능이 어떻게\
동작 하는지, 그리고 해당 기능을 구현하려면 어떻게 해야 하는지에 대해 간단하게 정리하는 내용을 작성해본다.

이번에 로그인에 사용할 SNS는 총 3가지를 사용한다. 카카오, 네이버, 구글 아이디를 통해 로그인 및 회원가입 처리를 할 수 있도록 개발할 예정이다. 각 서비스\
마다 로그인 방식이 조금씩 다르기 때문에 각각의 API 를 확인하여 로그인 기능을 구현해야 한다. 각 기능에 대해 정리해보기 전에 SNS 로그인이 어떻게 이루어 지는지\
간단하게 정리해본다.

### SNS 로그인 방식

일단 SNS 로그인에는 client, resource owner, resource server 3가지에 대해 알아야 한다. 간단하게 설명하자면\
**client = 우리 서비스**\
**resource owner = 사용자**\
**resource server = SNS 서버**\
라고 생각하면 된다. 연동 순서는 일단 네이버와 카카오 연동 기준으로 작성해본다.

1. resource owner(이하 RO) 가 client 에 SNS 로그인 버튼을 클릭한다.
2. client 는 resource server(이하 RS) 에 로그인 할 수 있는 URL 을 호출한다.
3. 각 RS 별 사용자 인증을 거쳐 client 에 제공해 줄 정보들에 대한 동의를 RO 에게 얻는다.
4. 모든 동의를 얻으면 RS는 access token 을 얻을 수 있는 코드를 client 에 리턴해준다.
5. client 는 해당 코드를 이용하여 access token 을 획득한다.
6. client 는 획득한 access token 을 이용 하여 사용자 정보를 조회한다.
7. 만일 사용자가 client 에 가입한 사용자면 로그인을, 가입하지 않았다면 client 의 회원가입 처리를 진행한다.

연동 순서를 유심히 보면 RO는 client 에 가입 혹은 로그인을 진행하긴 하지만 아이디와 패스워드를 별도로 client 에 입력하는 과정은 존재하지 않는다.\
단지 소셜에 로그인 버튼을 클릭하여 로그인과 회원가입 모두를 진행한다. 위와 같이 네이버나 카카오는 client 와 RO 사이에서 로그인을 중개해주는 역할을 한다.\
이렇게 중개자의 역할을 해주는 서비스가 바로 **OAuth** 다. RO 가 로그인을 하면 RS 는 client 에게 RO 의 아이디와 비밀번호를 넘겨주지 않고,\
사용자 정보를 얻을 수 있는 access token 을 제공해준다. client는 이 토큰을 이용하여 RS로 부터 사용자 정보를 제공 받을 수 있게 되는 것이다.


###9월 2일 
SNS 로그인 작업을 하면서 서칭 및 알게된 점들에 대해 간단히 정리해본다. 일단 카카오 기준으로 작성해보자면, 카카오의 경우 로그인 할 수 있는 
메소드를 2개 제공한다. 하나는 auth.login 이고 다른 하나는 auth.authorize 메소드이다. 둘의 차이는 아래와 같다.
#### auth.login
- 팝업 방식
- 별도의 리다이렉트 URL 이 필요없음

#### auth.authorize
- redirection 방식
- 리다이렉트 할 수 있는 URL이 명시되어야 함.

이번 개발에서 적용한 방식은 auth.login 방식을 적용했는데, 현재 개발하는 프로그램에 Capacitor를 이용한 웹뷰 형식의 하이브리드 앱이다. 
처음에는 authorize 메소드를 이용하여 개발을 진행하려 했는데, 그 이유는 authorize 메소드가 리다이렉트 방식을 사용하기 때문에 로그인 시
별도의 팝업 없이 로그인 절차를 진행하게 된다. login 메소드는 팝업 형식이라 하이브리드 앱에서 동작 시키기 위해선 User-Agent 값을 
변경시켜주어야 한다. 또한 팝업 동작 시 