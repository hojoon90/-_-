# 쿠키

* Set-Cookie: 서버에서 클라이언트로 쿠키 전달 (응답)
* Cookie: 클라이언트가 서버에서 받은 쿠키를 저장하고, HTTP 요청 시 서버로 전달

HTTP는 기본적으로 stateless 프로토콜임. 즉 서버와 클라이언트가 한번 요청과 응답을 주고받으면 연결이 끊어짐.\
이 이야기는 곧 서버에 클라이언트가 다시 요청을 하면 서버는 클라이언트를 기억하지 못한다는 것이다.\
이걸 해결하기 위해 쿠키를 사용하게 됨.

로그인 과정을 보면 다음과 같다.
* 클라이언트가 로그인 시 서버에서 응답으로 Set-Cookie 에 사용자 정보를 넣어서 전달한다.
* 클라이언트는 해당 쿠키를 브라우저의 쿠키저장소에 저장
* 이 후 클라이언트는 서버에 요청을 보낼 때 마다 쿠키저장소를 무조건 뒤져서 쿠키를 요청값에 담아서 보냄
* 서버는 넘어온 쿠키정보로 사용자 정보를 알게 됨.

쿠키의 사용처는 아래에서 대부분 사용
* 사용자 로그인 정보
* 광고 트래킹

또한 쿠키정보는 항상 서버에 전송된다. 네트워크 트래픽을 추가로 유발하는 것이다. 그렇기에
* 최소한의 정보만 사용한다 (세션ID, 인증토큰)
* 서버에 전송하지 않고 클라이언트 내부에 저장만 해두고 싶으면 웹 스토리지에 담아두면 된다.(localStorage, sessionStorage)

!!보안에 민감안 정보는 쿠키에 저장하지 않는다!

### 생명 주기
* expires: 만료일이 되면 쿠키 삭제
* max-age: 쿠키를 유지하는 시간. 0이나 음수를 지정하면 쿠키가 삭제된다.
* 세션 쿠키: 만료 날짜를 생략하면 브라우저 종료시 까지만 유지
* 영속 쿠키: 만료 날짜를 입력하면 해당 날짜까지 유지

### 도메인
쿠키는 도메인을 지정할 수 있음.
* 명시: 명시한 문서 기준 도메인 + 서브 도메인까지 포함.
  * domain=example.org 지정하여 쿠키 생성
    * example.org 쿠키 접근 가능
    * dev.example.org 쿠키 접근 가능
* 생략: 현재 문서 기준 도메인만 적용
  * example.org에서 쿠키 생성 후 domain 지정 생략
    * example.org 쿠키 접근 가능
    * dev.example.org 쿠키 접근 불가능

### 경로
* 경로를 포함한 하위 경로 페이지만 쿠키 접근
* 보통 path=/ 루트로 지정

### 보안
* Secure
  * Secure 적용 시 https인 경우에만 쿠키 전송
* HttpOnly
  * XSS 공격 방지
  * 자바스크립트에서 접근 불가
  * HTTP 전송에만 사용
* SameSite
  * XSRF 공격 방지
  * 요청 도메인과 쿠키에 설정된 도메인이 같은 경우만 쿠키 전송